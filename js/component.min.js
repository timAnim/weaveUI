var component={cleartxt:function(t){t.parentNode.getElementsByTagName("input")[0].value=""},Login:function(){if(userInit&&userInit.token)return void wv.href("/site/mylist");var t=function(t){var e=t.target;switch(e.id){case"loginDlg":wv.log.pop();break;case"cleartxt":wv.ui.cleartxt(e);break;case"forgetPwd":wv.href("/site/resetpwd/");break;case"signupBtn":wv.href("/site/signup/");break;case"loginBtn":if(!wv.id("username").value||!wv.id("password").value)return void wv.toast(lan.t("Check your input please"));wv.ajax({url:"/user/login",data:{account:wv.id("username").value,password:wv.id("password").value},success:function(t){wv.toast(lan.t("Login Success")),userInit.token=t.data.token,setTimeout(function(){wv.href("/site/mylist")},800)}});break;default:return}};document.body.appendChild(wv.toHTML(this.template.login)),wv.log.in("loginDlg"),wv.ontap(t,wv.id("loginDlg"))},logout:function(){function t(){wv.ajax({url:"/user/logout",method:"GET",success:function(){wv.toast(lan.t("Logoff Success")),setTimeout(function(){window.location.href="/site/index"},800)}})}wv.confirm(lan.t("Log out?"),t)},check:function(){if(window.userInit=wv.dataInit("userInit")||{},userInit&&userInit.token){var t=userInit.userImage;userInit.portrait=t&&t.guid?wv.getIMG(t,96):wv.defHead}}};define(function(){var t={dialog:"<dialog id='$id$' out='out-bottom'><ul><header><label><i class='fa fa-user'></i></label><h1>$title$</h1></header><content></content></ul><ul><li><button type='positive'>OK</button></li></ul></dialog>",checkItem:"<li class='blink-theme' name='check' id='$id$'><em>$value$</em><pre>$secondary$</pre><label type='switch' checked='false'><i class='fa fa-square-o'></i><i class='fa fa-check-square'></i></label></li>",radioItem:"<li class='blink-theme' name='radio' id='$id$'><em>$value$</em><pre>$secondary$</pre><label type='switch' checked='false'><i class='fa fa-circle-o'></i><i class='fa fa-dot-circle-o'></i></label></li>",inputItem:"<li><input autocomplete='off' value='$value$' type='$type$' placeholder='$placeholder$'><button name='clear'><i class='fa fa-times-circle'></i></button></li>",login:"<dialog id='loginDlg' out='out-bottom' ><ul><header><label><i class='fa fa-user'></i></label><h1>"+lan.t("Login Weave Mind")+"</h1></header><li><input id='username' placeholder='"+lan.t("Email")+"'/><button name='clear'><i class='fa fa-times-circle'></i></button></li><li><input id='password' placeholder='"+lan.t("Password")+"' type='password'/><button id='forgetPwd'>"+lan.t("Forgot")+"</button></li></ul><ul><button type='positive' id='loginBtn'>"+lan.t("Login")+"</ul><ul><button type='positive' id='signupBtn'>"+lan.t("Signup")+"</ul></dialog>",confirm:"<confirm id='$id$' out='out-bottom'><ul><h1>$title$</h1><li><button res='false' type='negtive'>"+lan.t("Cancel")+"</button><button res='true' type='positive'>"+lan.t("Confirm")+"</button></li></ul></confirm>"},e={chars:["0","1","2","3","4","5","6","7","8","9","a","b","b","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],randId:function(t){for(var e="",i=0;t>i;i++){var a=Math.ceil(35*Math.random());e+=this.chars[a]}return e}},i=function(t){for(var e,i,a=wv.findAll("label",t),o=[],n=[],l=a.length-1;l>=0;l--)"true"==a[l].getAttribute("checked")&&(e=a[l].parentNode.id,i=wv.find("em",a[l].parentNode).innerHTML,n.push(e),o.push(i));return{idArr:n,txtArr:o}},a=new Function;a.prototype.template_dialog=t.dialog,a.prototype.init=function(t){this.id=e.randId(4),this.title=t.title||this.defaultTitle,this.default=t.default||null,this.data=t.data||[],this.onSubmit=t.onSubmit||function(){};var i=wv.compose({id:this.id,title:this.title},this.template_dialog);document.body.appendChild(i),wv.log.in(this.id);for(var a=wv.findAll("button",this.id),o=this,n=a.length-1;n>=0;n--)wv.ontap(function(t){o.submit.call(o,o,t)},a[n]);t.data&&this.setData(t.data),t.onCreate&&t.onCreate(this)},a.prototype.setData=function(t){this.data=t;var e=wv.tag("content",this.id),i=wv.compose(t,this.template_item);e.appendChild(i)},a.prototype.submit=function(t){var e=i(wv.id(t.id));t.onSubmit(e),wv.log.pop()};var o=function(t){this.init(t)};o.prototype=new a,o.prototype.defaultTitle="多选框",o.prototype.template_item=t.checkItem;var n=function(t){this.init(t)};n.prototype=new a,n.prototype.defaultTitle="单选框",n.prototype.template_item=t.radioItem;var l=function(t){this.init(t)};l.prototype=new a,l.prototype.defaultTitle="输入文本",l.prototype.template_item=t.inputItem,l.prototype.submit=function(t){var e=wv.tag("input",wv.id(t.id)).value;t.onSubmit(e),wv.log.pop()};var r=function(t){var i=document.createElement("toast");i.innerHTML=t,i.id=e.randId(4),document.body.appendChild(i),setTimeout(function(){wv.anim.out(i,i,"out-opacity",200,wv.clean)},1500)},u=function(t){this.init(t)};u.prototype=new a,u.prototype.defaultTitle="确认",u.prototype.template_dialog=t.confirm,u.prototype.submit=function(t,e){var i="true"==e.target.getAttribute("res")?!0:!1;t.onSubmit(i),wv.log.pop()};var s=function(t){var e=t.target,i=e.tagName;switch("I"==i&&(e=e.parentNode),i){case"EM":case"PRE":case"LABEL":e=e.parentNode;break;case"ARTICLE":case"FORM":if("true"!=e.getAttribute("pause"))return;wv.log.pop()}var a=e.getAttribute("name");if(a)switch(a){case"check":var o=wv.find("label",e),n="true"==o.getAttribute("checked")?!1:!0;o.setAttribute("checked",n);break;case"radio":var l=e.parentNode;l=wv.findAll("label",l);for(var r=l.length-1;r>=0;r--)l[r].setAttribute("checked",!1);var o=wv.find("label",e),n="true"==o.getAttribute("checked")?!1:!0;o.setAttribute("checked",n);break;case"toggle":var o=wv.find("label",e),n="true"==o.getAttribute("checked")?!1:!0;o.setAttribute("checked",n);break;case"clear":var u=wv.find("input",e.parentNode);u.value=""}};return wv.ontap(s),{CheckDialog:o,RadioDialog:n,InputDialog:l,Toast:r,Confirm:u}});